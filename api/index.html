
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Peter Barrow">
      
      
      
        <link rel="prev" href="../first_steps/">
      
      
        <link rel="next" href="../license/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>API Reference - citrine</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="citrine" class="md-header__button md-logo" aria-label="citrine" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            citrine
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Peter-Barrow/citrine" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    PeterBarrow/citrine
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../first_steps/" class="md-tabs__link">
          
  
    
  
  Guides

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../license/" class="md-tabs__link">
        
  
    
  
  License

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="citrine" class="md-nav__button md-logo" aria-label="citrine" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    citrine
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Peter-Barrow/citrine" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    PeterBarrow/citrine
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../first_steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#crystal-modelling" class="md-nav__link">
    <span class="md-ellipsis">
      Crystal Modelling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Magnitude" class="md-nav__link">
    <span class="md-ellipsis">
      Magnitude
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.AngularFrequency" class="md-nav__link">
    <span class="md-ellipsis">
      AngularFrequency
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Wavelength" class="md-nav__link">
    <span class="md-ellipsis">
      Wavelength
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Wavelength">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Wavelength-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Wavelength.as_angular_frequency" class="md-nav__link">
    <span class="md-ellipsis">
      as_angular_frequency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Wavelength.as_wavevector" class="md-nav__link">
    <span class="md-ellipsis">
      as_wavevector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Wavelength.to_absolute" class="md-nav__link">
    <span class="md-ellipsis">
      to_absolute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Wavelength.to_unit" class="md-nav__link">
    <span class="md-ellipsis">
      to_unit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.spectral_window" class="md-nav__link">
    <span class="md-ellipsis">
      spectral_window
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.SellmeierCoefficientsSimple" class="md-nav__link">
    <span class="md-ellipsis">
      SellmeierCoefficientsSimple
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.SellmeierCoefficientsTemperatureDependent" class="md-nav__link">
    <span class="md-ellipsis">
      SellmeierCoefficientsTemperatureDependent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.SellmeierCoefficientsJundt" class="md-nav__link">
    <span class="md-ellipsis">
      SellmeierCoefficientsJundt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine._permittivity" class="md-nav__link">
    <span class="md-ellipsis">
      _permittivity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine._n_0" class="md-nav__link">
    <span class="md-ellipsis">
      _n_0
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine._n_i" class="md-nav__link">
    <span class="md-ellipsis">
      _n_i
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Orientation" class="md-nav__link">
    <span class="md-ellipsis">
      Orientation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.PhaseMatchingCondition" class="md-nav__link">
    <span class="md-ellipsis">
      PhaseMatchingCondition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Crystal" class="md-nav__link">
    <span class="md-ellipsis">
      Crystal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Crystal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Crystal-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Crystal.phase_matching" class="md-nav__link">
    <span class="md-ellipsis">
      phase_matching
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Crystal-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Crystal.refractive_index" class="md-nav__link">
    <span class="md-ellipsis">
      refractive_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Crystal.refractive_indices" class="md-nav__link">
    <span class="md-ellipsis">
      refractive_indices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.calculate_grating_period" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_grating_period
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.delta_k_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      delta_k_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.phase_mismatch" class="md-nav__link">
    <span class="md-ellipsis">
      phase_mismatch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.phase_matching_function" class="md-nav__link">
    <span class="md-ellipsis">
      phase_matching_function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.PhotonType" class="md-nav__link">
    <span class="md-ellipsis">
      PhotonType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.calculate_marginal_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_marginal_spectrum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.joint_spectral_amplitude" class="md-nav__link">
    <span class="md-ellipsis">
      joint_spectral_amplitude
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.bandwidth_conversion" class="md-nav__link">
    <span class="md-ellipsis">
      bandwidth_conversion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Time" class="md-nav__link">
    <span class="md-ellipsis">
      Time
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Time-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Time.to_absolute" class="md-nav__link">
    <span class="md-ellipsis">
      to_absolute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Time.to_unit" class="md-nav__link">
    <span class="md-ellipsis">
      to_unit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Bunching" class="md-nav__link">
    <span class="md-ellipsis">
      Bunching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.hom_interference_from_jsa" class="md-nav__link">
    <span class="md-ellipsis">
      hom_interference_from_jsa
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.hong_ou_mandel_interference" class="md-nav__link">
    <span class="md-ellipsis">
      hong_ou_mandel_interference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.spectral_purity" class="md-nav__link">
    <span class="md-ellipsis">
      spectral_purity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-matching-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Phase Matching Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.pmf_gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      pmf_gaussian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.pmf_antisymmetric" class="md-nav__link">
    <span class="md-ellipsis">
      pmf_antisymmetric
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pump-envelope-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Pump Envelope Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      gaussian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.sech2" class="md-nav__link">
    <span class="md-ellipsis">
      sech2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.skewed_gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      skewed_gaussian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crystal-library" class="md-nav__link">
    <span class="md-ellipsis">
      Crystal Library
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.KTiOPO4_Fradkin" class="md-nav__link">
    <span class="md-ellipsis">
      KTiOPO4_Fradkin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.KTiOPO4_Emanueli" class="md-nav__link">
    <span class="md-ellipsis">
      KTiOPO4_Emanueli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.KTiOAsO4_Emanueli" class="md-nav__link">
    <span class="md-ellipsis">
      KTiOAsO4_Emanueli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.LiNbO3_Zelmon" class="md-nav__link">
    <span class="md-ellipsis">
      LiNbO3_Zelmon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.LiNbO3_5molMgO_Zelmon" class="md-nav__link">
    <span class="md-ellipsis">
      LiNbO3_5molMgO_Zelmon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.LiNbO3_Newlight" class="md-nav__link">
    <span class="md-ellipsis">
      LiNbO3_Newlight
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.LiNbO3_5molMgO_Gayer" class="md-nav__link">
    <span class="md-ellipsis">
      LiNbO3_5molMgO_Gayer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brightness-and-heralding" class="md-nav__link">
    <span class="md-ellipsis">
      Brightness and Heralding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.photon_pair_coupling_filter" class="md-nav__link">
    <span class="md-ellipsis">
      photon_pair_coupling_filter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.single_photon_coupling_filter" class="md-nav__link">
    <span class="md-ellipsis">
      single_photon_coupling_filter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.brightness_and_heralding" class="md-nav__link">
    <span class="md-ellipsis">
      brightness_and_heralding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.calculate_optimisation_grid" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_optimisation_grid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.make_lookup_table" class="md-nav__link">
    <span class="md-ellipsis">
      make_lookup_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.BrightnessHeraldingLUT" class="md-nav__link">
    <span class="md-ellipsis">
      BrightnessHeraldingLUT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BrightnessHeraldingLUT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.BrightnessHeraldingLUT-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.BrightnessHeraldingLUT.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.BrightnessHeraldingLUT.interpolate" class="md-nav__link">
    <span class="md-ellipsis">
      interpolate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#crystal-modelling" class="md-nav__link">
    <span class="md-ellipsis">
      Crystal Modelling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Magnitude" class="md-nav__link">
    <span class="md-ellipsis">
      Magnitude
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.AngularFrequency" class="md-nav__link">
    <span class="md-ellipsis">
      AngularFrequency
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Wavelength" class="md-nav__link">
    <span class="md-ellipsis">
      Wavelength
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Wavelength">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Wavelength-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Wavelength.as_angular_frequency" class="md-nav__link">
    <span class="md-ellipsis">
      as_angular_frequency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Wavelength.as_wavevector" class="md-nav__link">
    <span class="md-ellipsis">
      as_wavevector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Wavelength.to_absolute" class="md-nav__link">
    <span class="md-ellipsis">
      to_absolute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Wavelength.to_unit" class="md-nav__link">
    <span class="md-ellipsis">
      to_unit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.spectral_window" class="md-nav__link">
    <span class="md-ellipsis">
      spectral_window
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.SellmeierCoefficientsSimple" class="md-nav__link">
    <span class="md-ellipsis">
      SellmeierCoefficientsSimple
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.SellmeierCoefficientsTemperatureDependent" class="md-nav__link">
    <span class="md-ellipsis">
      SellmeierCoefficientsTemperatureDependent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.SellmeierCoefficientsJundt" class="md-nav__link">
    <span class="md-ellipsis">
      SellmeierCoefficientsJundt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine._permittivity" class="md-nav__link">
    <span class="md-ellipsis">
      _permittivity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine._n_0" class="md-nav__link">
    <span class="md-ellipsis">
      _n_0
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine._n_i" class="md-nav__link">
    <span class="md-ellipsis">
      _n_i
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Orientation" class="md-nav__link">
    <span class="md-ellipsis">
      Orientation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.PhaseMatchingCondition" class="md-nav__link">
    <span class="md-ellipsis">
      PhaseMatchingCondition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Crystal" class="md-nav__link">
    <span class="md-ellipsis">
      Crystal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Crystal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Crystal-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Crystal.phase_matching" class="md-nav__link">
    <span class="md-ellipsis">
      phase_matching
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Crystal-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Crystal.refractive_index" class="md-nav__link">
    <span class="md-ellipsis">
      refractive_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Crystal.refractive_indices" class="md-nav__link">
    <span class="md-ellipsis">
      refractive_indices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.calculate_grating_period" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_grating_period
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.delta_k_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      delta_k_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.phase_mismatch" class="md-nav__link">
    <span class="md-ellipsis">
      phase_mismatch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.phase_matching_function" class="md-nav__link">
    <span class="md-ellipsis">
      phase_matching_function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.PhotonType" class="md-nav__link">
    <span class="md-ellipsis">
      PhotonType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.calculate_marginal_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_marginal_spectrum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.joint_spectral_amplitude" class="md-nav__link">
    <span class="md-ellipsis">
      joint_spectral_amplitude
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.bandwidth_conversion" class="md-nav__link">
    <span class="md-ellipsis">
      bandwidth_conversion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Time" class="md-nav__link">
    <span class="md-ellipsis">
      Time
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Time-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.Time.to_absolute" class="md-nav__link">
    <span class="md-ellipsis">
      to_absolute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.Time.to_unit" class="md-nav__link">
    <span class="md-ellipsis">
      to_unit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.Bunching" class="md-nav__link">
    <span class="md-ellipsis">
      Bunching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.hom_interference_from_jsa" class="md-nav__link">
    <span class="md-ellipsis">
      hom_interference_from_jsa
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.hong_ou_mandel_interference" class="md-nav__link">
    <span class="md-ellipsis">
      hong_ou_mandel_interference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.spectral_purity" class="md-nav__link">
    <span class="md-ellipsis">
      spectral_purity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-matching-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Phase Matching Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.pmf_gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      pmf_gaussian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.pmf_antisymmetric" class="md-nav__link">
    <span class="md-ellipsis">
      pmf_antisymmetric
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pump-envelope-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Pump Envelope Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      gaussian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.sech2" class="md-nav__link">
    <span class="md-ellipsis">
      sech2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.skewed_gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      skewed_gaussian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crystal-library" class="md-nav__link">
    <span class="md-ellipsis">
      Crystal Library
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.KTiOPO4_Fradkin" class="md-nav__link">
    <span class="md-ellipsis">
      KTiOPO4_Fradkin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.KTiOPO4_Emanueli" class="md-nav__link">
    <span class="md-ellipsis">
      KTiOPO4_Emanueli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.KTiOAsO4_Emanueli" class="md-nav__link">
    <span class="md-ellipsis">
      KTiOAsO4_Emanueli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.LiNbO3_Zelmon" class="md-nav__link">
    <span class="md-ellipsis">
      LiNbO3_Zelmon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.LiNbO3_5molMgO_Zelmon" class="md-nav__link">
    <span class="md-ellipsis">
      LiNbO3_5molMgO_Zelmon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.LiNbO3_Newlight" class="md-nav__link">
    <span class="md-ellipsis">
      LiNbO3_Newlight
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.LiNbO3_5molMgO_Gayer" class="md-nav__link">
    <span class="md-ellipsis">
      LiNbO3_5molMgO_Gayer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brightness-and-heralding" class="md-nav__link">
    <span class="md-ellipsis">
      Brightness and Heralding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.photon_pair_coupling_filter" class="md-nav__link">
    <span class="md-ellipsis">
      photon_pair_coupling_filter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.single_photon_coupling_filter" class="md-nav__link">
    <span class="md-ellipsis">
      single_photon_coupling_filter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.brightness_and_heralding" class="md-nav__link">
    <span class="md-ellipsis">
      brightness_and_heralding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.calculate_optimisation_grid" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_optimisation_grid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.make_lookup_table" class="md-nav__link">
    <span class="md-ellipsis">
      make_lookup_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrine.BrightnessHeraldingLUT" class="md-nav__link">
    <span class="md-ellipsis">
      BrightnessHeraldingLUT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BrightnessHeraldingLUT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.BrightnessHeraldingLUT-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citrine.BrightnessHeraldingLUT.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citrine.BrightnessHeraldingLUT.interpolate" class="md-nav__link">
    <span class="md-ellipsis">
      interpolate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API Reference</h1>
<h2 id="crystal-modelling">Crystal Modelling</h2>


<div class="doc doc-object doc-class">



<h2 id="citrine.Magnitude" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.Magnitude</span>


</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>Enum to define the magnitude prefixes for units such as pico, nano,
micro, etc.</p>














  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.AngularFrequency" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.AngularFrequency</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">AngularFrequency</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


        <p>Class to represent angular frequency.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.AngularFrequency.value">value</span></code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.ndarray">ndarray</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The angular frequency.</p>
          </div>
        </li>
    </ul>














  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.Wavelength" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.Wavelength</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">Wavelength</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Magnitude</span> <span class="o">=</span> <span class="n">Magnitude</span><span class="o">.</span><span class="n">nano</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


        <p>Class to represent wavelength with unit conversion.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.Wavelength.value">value</span></code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.ndarray">ndarray</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The wavelength value.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.Wavelength.unit">unit</span></code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Magnitude (citrine.citrine.Magnitude)" href="#citrine.Magnitude">Magnitude</a></code>)
          –
          <div class="doc-md-description">
            <p>The unit of the wavelength (default: nano).</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            as_angular_frequency (citrine.Wavelength.as_angular_frequency)" href="#citrine.Wavelength.as_angular_frequency">as_angular_frequency</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert the wavelength to angular frequency.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            as_wavevector (citrine.Wavelength.as_wavevector)" href="#citrine.Wavelength.as_wavevector">as_wavevector</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert the wavelength to a wavevector.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            to_absolute (citrine.Wavelength.to_absolute)" href="#citrine.Wavelength.to_absolute">to_absolute</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert the wavelength to base units (meters).</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            to_unit (citrine.Wavelength.to_unit)" href="#citrine.Wavelength.to_unit">to_unit</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert the wavelength to a new unit.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">







<h3 id="citrine.Wavelength-functions">Functions</h3>

<div class="doc doc-object doc-function">


<h4 id="citrine.Wavelength.as_angular_frequency" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">as_angular_frequency</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">as_angular_frequency</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">AngularFrequency</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the wavelength to angular frequency.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>AngularFrequency</code></b> (              <code><a class="autorefs autorefs-internal" title="            citrine.AngularFrequency


  
      dataclass
   (citrine.citrine.AngularFrequency)" href="#citrine.AngularFrequency">AngularFrequency</a></code>
)          –
          <div class="doc-md-description">
            <p>Angular frequency corresponding to the
wavelength.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="citrine.Wavelength.as_wavevector" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">as_wavevector</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">as_wavevector</span><span class="p">(</span><span class="n">refractive_index</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the wavelength to a wavevector.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>float</code></b> (              <code><span title="float">float</span> | <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
)          –
          <div class="doc-md-description">
            <p>The wavevector.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="citrine.Wavelength.to_absolute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_absolute</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_absolute</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Wavelength</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the wavelength to base units (meters).</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>Wavelength</code></b> (              <code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>
)          –
          <div class="doc-md-description">
            <p>Wavelength in meters.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="citrine.Wavelength.to_unit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_unit</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_unit</span><span class="p">(</span><span class="n">new_unit</span><span class="p">:</span> <span class="n">Magnitude</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavelength</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the wavelength to a new unit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>new_unit</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Magnitude (citrine.citrine.Magnitude)" href="#citrine.Magnitude">Magnitude</a></code>)
          –
          <div class="doc-md-description">
            <p>The desired unit for the wavelength.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>Wavelength</code></b> (              <code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>
)          –
          <div class="doc-md-description">
            <p>New Wavelength object with converted units.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.spectral_window" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.spectral_window</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">spectral_window</span><span class="p">(</span><span class="n">central_wavelength</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">spectral_width</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavelength</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Generate an array of wavelengths within a specified spectral window.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>central_wavelength</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>The central wavelength.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>spectral_width</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>The total spectral width.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>steps</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>The number of steps for the wavelength range.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>Wavelength</code></b> (              <code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>
)          –
          <div class="doc-md-description">
            <p>An array of wavelengths within the specified window.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.SellmeierCoefficientsSimple" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.SellmeierCoefficientsSimple</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SellmeierCoefficientsSimple</span><span class="p">(</span><span class="n">coefficients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dn_dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">















  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.SellmeierCoefficientsTemperatureDependent" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.SellmeierCoefficientsTemperatureDependent</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SellmeierCoefficientsTemperatureDependent</span><span class="p">(</span><span class="n">first_order</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">second_order</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">zeroth_order</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">















  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.SellmeierCoefficientsJundt" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.SellmeierCoefficientsJundt</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SellmeierCoefficientsJundt</span><span class="p">(</span><span class="n">a_terms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">b_terms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">















  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine._permittivity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine._permittivity</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">_permittivity</span><span class="p">(</span><span class="n">sellmeier</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">wavelength_um</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Compute the permittivity using the Sellmeier equation.</p>
<p>This modification adds comments to explain each step of the Sellmeier
equation calculation. The code is implementing the Sellmeier equation,
which is used to determine the refractive index of a material as a
function of wavelength.</p>
<p>The equation typically takes the form:</p>
<div class="arithmatex">\[
n^2 = A + \frac{B * λ^2}{λ^2 - C} + \frac{D * λ^2}{λ^2 - E} + \ldots
\]</div>
<p>Where n is the refractive index, λ is the wavelength, and A, B, C, D, E,
etc. are the Sellmeier coefficients specific to the material.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>sellmeier</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<span title="float">float</span>], <span title="numpy.typing.NDArray">NDArray</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Sellmeier coefficients.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>wavelength_um</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Wavelength in micrometers.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>float</code></b> (              <code><span title="float">float</span> | <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
)          –
          <div class="doc-md-description">
            <p>The permittivity value.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/citrine/citrine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_permittivity</span><span class="p">(</span>
    <span class="n">sellmeier</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">],</span>
    <span class="n">wavelength_um</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the permittivity using the Sellmeier equation.</span>

<span class="sd">    This modification adds comments to explain each step of the Sellmeier</span>
<span class="sd">    equation calculation. The code is implementing the Sellmeier equation,</span>
<span class="sd">    which is used to determine the refractive index of a material as a</span>
<span class="sd">    function of wavelength.</span>

<span class="sd">    The equation typically takes the form:</span>

<span class="sd">    $$</span>
<span class="sd">    n^2 = A + \\frac{B * λ^2}{λ^2 - C} + \\frac{D * λ^2}{λ^2 - E} + \\ldots</span>
<span class="sd">    $$</span>

<span class="sd">    Where n is the refractive index, λ is the wavelength, and A, B, C, D, E,</span>
<span class="sd">    etc. are the Sellmeier coefficients specific to the material.</span>

<span class="sd">    Args:</span>
<span class="sd">        sellmeier (Union[List[float], NDArray]): Sellmeier coefficients.</span>
<span class="sd">        wavelength_um (float): Wavelength in micrometers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The permittivity value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Take array of sellemeier coefficients of the form [A, B, C, D, E, ...]</span>
    <span class="c1"># and split into A, [B, C, ...], E</span>
    <span class="n">first</span><span class="p">,</span> <span class="o">*</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="n">sellmeier</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="c1"># Square the wavelength (in micrometers)</span>
    <span class="n">wl</span> <span class="o">=</span> <span class="n">wavelength_um</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># Initialize the permittivity with the first coefficient</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">first</span>

    <span class="c1"># Iterate through the Sellmeier coefficients in pairs</span>
    <span class="c1"># coeffs[0::2] correspond to B, D, ... -&gt; numerator</span>
    <span class="c1"># coeffs[1::2] correspond to C, E, ... -&gt; denominator</span>
    <span class="k">for</span> <span class="n">number</span><span class="p">,</span> <span class="n">denom</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]):</span>
        <span class="c1"># Apply the Sellmeier equation term:</span>
        <span class="c1"># Add (numerator) / (1 - denominator / wavelength^2)</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">number</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">denom</span> <span class="o">/</span> <span class="n">wl</span><span class="p">)</span>

    <span class="c1"># Apply the final term of the Sellmeier equation</span>
    <span class="c1"># Subtract the last coefficient multiplied by the squared wavelength</span>
    <span class="n">p</span> <span class="o">-=</span> <span class="n">last</span> <span class="o">*</span> <span class="n">wl</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine._n_0" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine._n_0</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">_n_0</span><span class="p">(</span><span class="n">sellmeier</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">wavelength_um</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate the refractive index (n_0) using the zeroth-order Sellmeier
    coefficients.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>sellmeier</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<span title="float">float</span>], <span title="numpy.typing.NDArray">NDArray</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Zeroth-order Sellmeier
coefficients.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>wavelength_um</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Wavelength in micrometers.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>float</code></b> (              <code><span title="float">float</span> | <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
)          –
          <div class="doc-md-description">
            <p>The refractive index (n_0).</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/citrine/citrine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_n_0</span><span class="p">(</span>
    <span class="n">sellmeier</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">],</span>
    <span class="n">wavelength_um</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the refractive index (n_0) using the zeroth-order Sellmeier</span>
<span class="sd">        coefficients.</span>

<span class="sd">    Args:</span>
<span class="sd">        sellmeier (Union[List[float], NDArray]): Zeroth-order Sellmeier</span>
<span class="sd">            coefficients.</span>
<span class="sd">        wavelength_um (float): Wavelength in micrometers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The refractive index (n_0).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">_permittivity</span><span class="p">(</span><span class="n">sellmeier</span><span class="p">,</span> <span class="n">wavelength_um</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine._n_i" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine._n_i</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">_n_i</span><span class="p">(</span><span class="n">sellmeier</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">wavelength_um</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate the refractive index (n_i) using the higher-order Sellmeier
    coefficients.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>sellmeier</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<span title="float">float</span>], <span title="numpy.typing.NDArray">NDArray</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Higher-order Sellmeier
coefficients.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>wavelength_um</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Wavelength in micrometers.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>float</code></b> (              <code><span title="float">float</span> | <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
)          –
          <div class="doc-md-description">
            <p>The refractive index (n_i).</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/citrine/citrine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_n_i</span><span class="p">(</span>
    <span class="n">sellmeier</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]],</span>
    <span class="n">wavelength_um</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the refractive index (n_i) using the higher-order Sellmeier</span>
<span class="sd">        coefficients.</span>

<span class="sd">    Args:</span>
<span class="sd">        sellmeier (Union[List[float], NDArray]): Higher-order Sellmeier</span>
<span class="sd">            coefficients.</span>
<span class="sd">        wavelength_um (float): Wavelength in micrometers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The refractive index (n_i).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sellmeier</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="n">s</span> <span class="o">/</span> <span class="p">(</span><span class="n">wavelength_um</span><span class="o">**</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.Orientation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.Orientation</span>


</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>Enum to represent the orientation: ordinary or extraordinary.</p>














  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.PhaseMatchingCondition" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.PhaseMatchingCondition</span>


</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>Phase-matching configurations for nonlinear optical processes.</p>
<p>Each configuration defines the polarization orientations for (pump, signal,
    idler) where:</p>
<pre><code>- o/O: ordinary polarization (horizontal, H)

- e/E: extraordinary polarization (vertical, V)
</code></pre>


<details class="the-configurations-are" open>
  <summary>The configurations are</summary>
  <ul>
<li>Type 0 (o): All waves ordinary polarized (H,H,H), <code>type0_o</code></li>
<li>Type 0 (e): All waves extraordinary polarized (V,V,V), <code>type0_e</code></li>
<li>Type 1: Pump extraordinary, signal/idler ordinary (V,H,H), <code>type1</code></li>
<li>Type 2 (o): Mixed polarizations (V,H,V), <code>type2_o</code></li>
<li>Type 2 (e): Mixed polarizations (V,V,H), <code>type2_e</code></li>
</ul>
</details>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Ordinary (o) corresponds to horizontal (H) polarization</li>
<li>Extraordinary (e) corresponds to vertical (V) polarization</li>
<li>The tuple order is always (pump, signal, idler)</li>
</ul>
</details>













  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.Crystal" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.Crystal</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">Crystal</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sellmeier_o</span><span class="p">:</span> <span class="n">SellmeierCoefficientsSimple</span> <span class="o">|</span> <span class="n">SellmeierCoefficientsTemperatureDependent</span> <span class="o">|</span> <span class="n">SellmeierCoefficientsJundt</span> <span class="o">|</span> <span class="n">SellmeierCoefficientsBornAndWolf</span><span class="p">,</span> <span class="n">sellmeier_e</span><span class="p">:</span> <span class="n">SellmeierCoefficientsSimple</span> <span class="o">|</span> <span class="n">SellmeierCoefficientsTemperatureDependent</span> <span class="o">|</span> <span class="n">SellmeierCoefficientsJundt</span> <span class="o">|</span> <span class="n">SellmeierCoefficientsBornAndWolf</span><span class="p">,</span> <span class="n">phase_matching</span><span class="p">:</span> <span class="n">PhaseMatchingCondition</span><span class="p">,</span> <span class="n">doi</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


        <p>Class to represent a nonlinear crystal for refractive index and phase
    matching calculations.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.Crystal.__init__.name">name</span></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Name of the crystal.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.Crystal.__init__.sellmeier_o">sellmeier_o</span></code></b>
              (<code><span title="SellmeierCoefficients">SellmeierCoefficients</span></code>)
          –
          <div class="doc-md-description">
            <p>Ordinary Sellmeier
coefficients.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.Crystal.__init__.sellmeier_e">sellmeier_e</span></code></b>
              (<code><span title="SellmeierCoefficients">SellmeierCoefficients</span></code>)
          –
          <div class="doc-md-description">
            <p>Extraordinary Sellmeier
coefficients.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.Crystal.__init__.phase_matching">phase_matching</span></code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.PhaseMatchingCondition (citrine.citrine.PhaseMatchingCondition)" href="#citrine.PhaseMatchingCondition">PhaseMatchingCondition</a></code>)
          –
          <div class="doc-md-description">
            <p>Phase matching conditions.</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            refractive_index (citrine.Crystal.refractive_index)" href="#citrine.Crystal.refractive_index">refractive_index</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculate the refractive index for a given wavelength and polarization</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            refractive_indices (citrine.Crystal.refractive_indices)" href="#citrine.Crystal.refractive_indices">refractive_indices</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculate the refractive indices for the pump, signal, and idler</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="            phase_matching


  
      property
      writable
   (citrine.Crystal.phase_matching)" href="#citrine.Crystal.phase_matching">phase_matching</a></code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.PhaseMatchingCondition (citrine.citrine.PhaseMatchingCondition)" href="#citrine.PhaseMatchingCondition">PhaseMatchingCondition</a></code>)
          –
          <div class="doc-md-description">
            <p>Get the current phase matching condition.</p>
          </div>
        </li>
    </ul>




  <div class="doc doc-children">





<h3 id="citrine.Crystal-attributes">Attributes</h3>

<div class="doc doc-object doc-attribute">



<h4 id="citrine.Crystal.phase_matching" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">phase_matching</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">phase_matching</span><span class="p">:</span> <span class="n">PhaseMatchingCondition</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the current phase matching condition.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="            citrine.PhaseMatchingCondition (citrine.citrine.PhaseMatchingCondition)" href="#citrine.PhaseMatchingCondition">PhaseMatchingCondition</a></code>
          –
          <div class="doc-md-description">
            <p>Current phase matching configuration.</p>
          </div>
        </li>
    </ul>

    </div>

</div>

<h3 id="citrine.Crystal-functions">Functions</h3>

<div class="doc doc-object doc-function">


<h4 id="citrine.Crystal.refractive_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">refractive_index</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">refractive_index</span><span class="p">(</span><span class="n">wavelength</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">photon</span><span class="p">:</span> <span class="n">Photon</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the refractive index for a given wavelength and polarization
    using the Sellmeier equation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>wavelength</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Wavelength.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>photon</code></b>
              (<code><span title="citrine.citrine.Photon">Photon</span></code>)
          –
          <div class="doc-md-description">
            <p>Photon type.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Temperature in Celsius (defaults to
reference temperature).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>float</code></b> (              <code><span title="float">float</span> | <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Refractive index.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="citrine.Crystal.refractive_indices" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">refractive_indices</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">refractive_indices</span><span class="p">(</span><span class="n">pump_wavelength</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">signal_wavelength</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">idler_wavelength</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the refractive indices for the pump, signal, and idler
    photons.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pump_wavelength</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Pump photon wavelength.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>signal_wavelength</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Signal photon wavelength.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>idler_wavelength</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Idler photon wavelength.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Temperature in Celsius (defaults to
reference temperature).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="float">float</span> | <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>], <span title="float">float</span> | <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>], <span title="float">float</span> | <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>
          –
          <div class="doc-md-description">
            <p>Tuple[float, float, float]: Refractive indices for the pump,
signal, and idler photons.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.calculate_grating_period" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.calculate_grating_period</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_grating_period</span><span class="p">(</span><span class="n">lambda_p_central</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">lambda_s_central</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">lambda_i_central</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">crystal</span><span class="p">:</span> <span class="n">Crystal</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate the grating period (Λ) for the phase matching condition.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>lambda_p_central</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Central wavelength of the pump.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_s_central</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Central wavelength of the signal.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_i_central</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Central wavelength of the idler.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>float</code></b> (              <code><span title="float">float</span> | <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Grating period in microns.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.delta_k_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.delta_k_matrix</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delta_k_matrix</span><span class="p">(</span><span class="n">lambda_p</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">lambda_s</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">lambda_i</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">crystal</span><span class="p">:</span> <span class="n">Crystal</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate the Δk matrix for the phase matching function using the
    wavevector</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>lambda_p</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Central wavelength of the pump.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_s</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Signal wavelengths (Wavelength type).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_i</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Idler wavelengths (Wavelength type).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>grating_period</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Grating period in microns.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="float">float</span> | <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
          –
          <div class="doc-md-description">
            <p>np.ndarray: A 2D matrix of Δk values.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.phase_mismatch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.phase_mismatch</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">phase_mismatch</span><span class="p">(</span><span class="n">lambda_p</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">lambda_s</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">crystal</span><span class="p">:</span> <span class="n">Crystal</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">grating_period</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.phase_matching_function" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.phase_matching_function</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">phase_matching_function</span><span class="p">(</span><span class="n">delta_k</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">grating_period</span><span class="p">,</span> <span class="n">crystal_length</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Compute the phase matching function as a sinc function of Δk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>delta_k</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>The Δk matrix from the phase matching condition.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>np.ndarray: The phase matching function.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.PhotonType" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.PhotonType</span>


</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>















  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.calculate_marginal_spectrum" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.calculate_marginal_spectrum</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_marginal_spectrum</span><span class="p">(</span><span class="n">jsa_matrix</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">lambda_s</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">lambda_i</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">photon_type</span><span class="p">:</span> <span class="n">PhotonType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate the marginal spectrum for either signal or idler photons from a
    JSA matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>jsa_matrix</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D complex matrix representing the joint spectral
amplitude. Shape (len(lambda_s), len(lambda_i)) with indexing='ij'.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_s</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Signal wavelengths (Wavelength type).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_i</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Idler wavelengths (Wavelength type).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>photon_type</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.PhotonType (citrine.citrine.PhotonType)" href="#citrine.PhotonType">PhotonType</a></code>)
          –
          <div class="doc-md-description">
            <p>Enum specifying whether to calculate for SIGNAL or IDLER
photon.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
          –
          <div class="doc-md-description">
            <p>Tuple containing:
- Array of wavelengths for the selected photon
- Array of corresponding intensity values (complex)</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.joint_spectral_amplitude" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.joint_spectral_amplitude</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">joint_spectral_amplitude</span><span class="p">(</span><span class="n">phase_mismatch_matrix</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">pump_envelope_matrix</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">normalisation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents first">


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.bandwidth_conversion" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.bandwidth_conversion</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">bandwidth_conversion</span><span class="p">(</span><span class="n">delta_lambda_FWHM</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">pump_wl</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Convert pump bandwidth from FWHM in wavelength to frequency.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>delta_lambda_FWHM</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Bandwidth in wavelength units.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>pump_wl</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Central pump wavelength.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>float</code></b> (              <code><span title="float">float</span></code>
)          –
          <div class="doc-md-description">
            <p>Converted bandwidth.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.Time" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.Time</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">Time</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Magnitude</span> <span class="o">=</span> <span class="n">Magnitude</span><span class="o">.</span><span class="n">base</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


        <p>Class to represent time in chosen units</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.Time.value">value</span></code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.ndarray">ndarray</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The time in chosen units</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.Time.unit">unit</span></code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Magnitude (citrine.citrine.Magnitude)" href="#citrine.Magnitude">Magnitude</a></code>)
          –
          <div class="doc-md-description">
            <p>The unit of time</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            to_absolute (citrine.Time.to_absolute)" href="#citrine.Time.to_absolute">to_absolute</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert the time to base units (seconds).</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            to_unit (citrine.Time.to_unit)" href="#citrine.Time.to_unit">to_unit</a></code></b>
            –
            <div class="doc-md-description">
              <p>Convert the time to a new unit.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">







<h3 id="citrine.Time-functions">Functions</h3>

<div class="doc doc-object doc-function">


<h4 id="citrine.Time.to_absolute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_absolute</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_absolute</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Time</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the time to base units (seconds).</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>Time</code></b> (              <code><a class="autorefs autorefs-internal" title="            citrine.Time


  
      dataclass
   (citrine.citrine.Time)" href="#citrine.Time">Time</a></code>
)          –
          <div class="doc-md-description">
            <p>Time in seconds.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="citrine.Time.to_unit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_unit</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_unit</span><span class="p">(</span><span class="n">new_unit</span><span class="p">:</span> <span class="n">Magnitude</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Time</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the time to a new unit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>new_unit</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Magnitude (citrine.citrine.Magnitude)" href="#citrine.Magnitude">Magnitude</a></code>)
          –
          <div class="doc-md-description">
            <p>The desired unit for the Time.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>time</code></b> (              <code><a class="autorefs autorefs-internal" title="            citrine.Time


  
      dataclass
   (citrine.citrine.Time)" href="#citrine.Time">Time</a></code>
)          –
          <div class="doc-md-description">
            <p>New Time object with converted units.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.Bunching" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.Bunching</span>


</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>















  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.hom_interference_from_jsa" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.hom_interference_from_jsa</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">hom_interference_from_jsa</span><span class="p">(</span><span class="n">joint_spectral_amplitude</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">wavelengths_signal</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">wavelengths_idler</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">time_delay</span><span class="p">:</span> <span class="n">Time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Magnitude</span><span class="o">.</span><span class="n">base</span><span class="p">),</span> <span class="n">bunching</span><span class="p">:</span> <span class="n">Bunching</span> <span class="o">=</span> <span class="n">Bunching</span><span class="o">.</span><span class="n">Bunching</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculates the Hong-Ou-Mandel (HOM) interference pattern and total
    coincidence rate</p>
<p>This function computes the quantum interference that occurs when two
    photons enter a 50:50 beam splitter from different inputs. The
    interference pattern depends on the joint spectral amplitude (JSA) of
    the photon pair and the time delay between their arrivals at the beam
    splitter.</p>
<p>The calculation follows these steps:
1. Create the second JSA with swapped signal and idler (anti-transpose)
2. Apply a phase shift based on the time delay and wavelength difference
3. Calculate the interference between the two quantum pathways
4. Compute the joint spectral intensity (JSI) by taking the squared
    magnitude</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>jsa</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>Complex 2D numpy array of shape (M, N) representing
the Joint Spectral Amplitude. The first dimension corresponds to
signal wavelengths and the second dimension to idler wavelengths.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>wavelengths_signal</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>1D array of signal wavelengths in
meters, must match the first dimension of jsa.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>wavelengths_idler</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>1D array of idler wavelengths in
meters, must match the second dimension of jsa. Note: should be in
    descending order to match standard convention.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>time_delay</code></b>
              (<code>float = 0.0</code>, default:
                  <code><a class="autorefs autorefs-internal" title="            citrine.Time


  
      dataclass
   (citrine.citrine.Time)" href="#citrine.Time">Time</a>(0.0, <span title="citrine.citrine.Magnitude.base">base</span>)</code>
)
          –
          <div class="doc-md-description">
            <p>Time delay between signal and idler photons
in seconds. At zero delay, maximum quantum interference occurs for
indistinguishable photons.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>bunching</code></b>
              (<code>Bunching = Bunching.Bunching</code>, default:
                  <code><span title="citrine.citrine.Bunching.Bunching">Bunching</span></code>
)
          –
          <div class="doc-md-description">
            <p>Type of interference to be
simulated</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="numpy.ndarray">ndarray</span>]</code>
          –
          <div class="doc-md-description">
            <p>Tuple containing:
- float: Total coincidence probability (sum of all JSI values).
- np.ndarray: 2D array representing the joint spectral intensity
    after interference.</p>
          </div>
        </li>
    </ul>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Hong-Ou-Mandel interference results from the destructive interference
    between two indistinguishable two-photon quantum states. For
    perfectly indistinguishable photons at zero time delay, they will
    always exit the beam splitter together from the same port,
    resulting in zero coincidence count rate (the HOM dip).</p>
<p>The time delay introduces a wavelength-dependent phase shift to one
    pathway, reducing the interference and increasing the coincidence
    probability.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.hong_ou_mandel_interference" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.hong_ou_mandel_interference</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">hong_ou_mandel_interference</span><span class="p">(</span><span class="n">jsa</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">signal_wavelengths</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">idler_wavelengths</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">time_delays</span><span class="p">:</span> <span class="n">Time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Magnitude</span><span class="o">.</span><span class="n">base</span><span class="p">),</span> <span class="n">bunching</span><span class="p">:</span> <span class="n">Bunching</span> <span class="o">=</span> <span class="n">Bunching</span><span class="o">.</span><span class="n">Bunching</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculates the complete Hong-Ou-Mandel dip by scanning the time delays.</p>
<p>This function generates the characteristic HOM dip by calculating the
    coincidence rate at each time delay value in the provided array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>jsa</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>Complex 2D numpy array representing the Joint Spectral Amplitude.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>signal_wavelengths</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>1D array of signal wavelengths in meters.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>idler_wavelengths</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>1D array of idler wavelengths in meters.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>time_delays</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Time


  
      dataclass
   (citrine.citrine.Time)" href="#citrine.Time">Time</a></code>, default:
                  <code><a class="autorefs autorefs-internal" title="            citrine.Time


  
      dataclass
   (citrine.citrine.Time)" href="#citrine.Time">Time</a>(0.0, <span title="citrine.citrine.Magnitude.base">base</span>)</code>
)
          –
          <div class="doc-md-description">
            <p>1D array of time delay values in seconds to scan across.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>np.ndarray: 1D array of coincidence rates corresponding to each time
delay, showing the characteristic HOM dip.</p>
          </div>
        </li>
    </ul>


<details class="physics-notes" open>
  <summary>Physics Notes</summary>
  <p>The width of the HOM dip is inversely proportional to the spectral
    bandwidth of the photons. Spectrally narrower photons produce wider
    dips, while broader bandwidth photons produce narrower dips,
    demonstrating the time-frequency uncertainty principle.</p>
<p>The shape and visibility of the dip reveals information about the
spectral entanglement and distinguishability of the photon pairs.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.spectral_purity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.spectral_purity</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">spectral_purity</span><span class="p">(</span><span class="n">jsa</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate the spectral purity of a biphoton state</p>
<p>This function calculate the spectral purity, schmidt number and entropy of
    a biphoton state. This is achieved by performing a singular value
    decomposition (SVD) a discrete analogue to the Schmidt decomposition
    (continuous space).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>joint_spectral_amplitude</code></b>
          –
          <div class="doc-md-description">
            <p>2D array representing the joint spectral
amplitude.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>tuple</code></b> (              <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>]</code>
)          –
          <div class="doc-md-description">
            <p>A tuple containing:
- probabilities (NDArray): Normalized HOM interference pattern
- purity (float): Spectral purity of the state (0 to 1)
- schmidt_number (float): Schmidt number indicating mode
    entanglement</p>
          </div>
        </li>
    </ul>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The function performs these steps:
1. Singular value decomposition of the JSA
2. Computes quantum metrics (purity, Schmidt number, entropy)</p>
</details>

    </div>

</div><h2 id="phase-matching-functions">Phase Matching Functions</h2>


<div class="doc doc-object doc-function">


<h2 id="citrine.pmf_gaussian" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.pmf_gaussian</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">pmf_gaussian</span><span class="p">(</span><span class="n">delta_k</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">poling_period</span><span class="p">,</span> <span class="n">crystal_length</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate the Gaussian phase-matching function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>delta_k</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>The delta k values.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>poling_period</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The poling period of the crystal.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>crystal_length</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The length of the crystal.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>np.ndarray: The Gaussian phase-matching function values.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/citrine/phase_matching.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pmf_gaussian</span><span class="p">(</span>
    <span class="n">delta_k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">poling_period</span><span class="p">,</span> <span class="n">crystal_length</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the Gaussian phase-matching function.</span>

<span class="sd">    Args:</span>
<span class="sd">        delta_k (np.ndarray): The delta k values.</span>
<span class="sd">        poling_period (float): The poling period of the crystal.</span>
<span class="sd">        crystal_length (float): The length of the crystal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: The Gaussian phase-matching function values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_delta_k</span> <span class="o">=</span> <span class="n">_adjusted_delta_k</span><span class="p">(</span><span class="n">delta_k</span><span class="p">,</span> <span class="n">poling_period</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">_delta_k</span> <span class="o">*</span> <span class="p">(</span><span class="n">crystal_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.pmf_antisymmetric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.pmf_antisymmetric</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">pmf_antisymmetric</span><span class="p">(</span><span class="n">delta_k</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">poling_period</span><span class="p">,</span> <span class="n">crystal_length</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate the antisymmetric phase-matching function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>delta_k</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>The delta k values.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>poling_period</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The poling period of the crystal.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>crystal_length</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The length of the crystal.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>np.ndarray: The antisymmetric phase-matching function values.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/citrine/phase_matching.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pmf_antisymmetric</span><span class="p">(</span>
    <span class="n">delta_k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">poling_period</span><span class="p">,</span> <span class="n">crystal_length</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the antisymmetric phase-matching function.</span>

<span class="sd">    Args:</span>
<span class="sd">        delta_k (np.ndarray): The delta k values.</span>
<span class="sd">        poling_period (float): The poling period of the crystal.</span>
<span class="sd">        crystal_length (float): The length of the crystal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: The antisymmetric phase-matching function values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_delta_k</span> <span class="o">=</span> <span class="n">_adjusted_delta_k</span><span class="p">(</span><span class="n">delta_k</span><span class="p">,</span> <span class="n">poling_period</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">_delta_k</span> <span class="o">*</span> <span class="p">(</span><span class="n">crystal_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">_delta_k</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="pump-envelope-functions">Pump Envelope Functions</h2>


<div class="doc doc-object doc-function">


<h2 id="citrine.gaussian" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.gaussian</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">gaussian</span><span class="p">(</span><span class="n">lambda_p</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lambda_s</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">lambda_i</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Generate a pump envelope matrix with a Gaussian profile.</p>
<p>Implements a Gaussian pump envelope in frequency space according to:
$$
\alpha(\omega_s + \omega_i) = \exp\left(-\frac{(\omega_s + \omega_i - \omega_p)^2}{\sigma_p^2}\right)
$$</p>
<p>Can be chirped according to:
$$
\chi(\omega_s + \omega_i) = \exp(-ik(\omega_s + \omega_i - \omega_p)^2),
$$</p>
<p>returning <span class="arithmatex">\(\alpha\omega_s + \omega_i \cdot \chi\omega_s + \omega_i\)</span></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>lambda_p</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Central wavelength of the pump.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>sigma_p</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Pump bandwidth.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_s</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Signal wavelengths array.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_i</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Idler wavelengths array.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>k</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Chirp parameter, controls strength and direction of
chirp. Positive values create up-chirp, negative values create
down-chirp.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 2D pump envelope matrix.</p>
          </div>
        </li>
    </ul>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The equation uses the following variables:
    <span class="arithmatex">\(\omega_s\)</span>: signal frequency
    <span class="arithmatex">\(\omega_i\)</span>: idler frequency
    <span class="arithmatex">\(\omega_p\)</span>: pump central frequency
    <span class="arithmatex">\(\sigma_p\)</span>: pump bandwidth</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.sech2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.sech2</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sech2</span><span class="p">(</span><span class="n">lambda_p</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lambda_s</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">lambda_i</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Generate a pump envelope matrix with a hyperbolic secant squared profile.</p>
<p>Implements a sech² pump envelope in frequency space according to:
$$
\alpha(\omega_s + \omega_i) = \text{sech}^2(\pi\sigma_p(\omega_s + \omega_i - \omega_p))
$$</p>
<p>Can be chirped according to:
$$
\chi(\omega_s + \omega_i) = \exp(-ik(\omega_s + \omega_i - \omega_p)^2),
$$</p>
<p>returning <span class="arithmatex">\(\alpha\omega_s + \omega_i \cdot \chi\omega_s + \omega_i\)</span></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>lambda_p</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Central wavelength of the pump.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>sigma_p</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Pump bandwidth parameter.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_s</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Signal wavelengths array.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_i</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Idler wavelengths array.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>k</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Chirp parameter, controls strength and direction of
chirp. Positive values create up-chirp, negative values create
down-chirp.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 2D pump envelope matrix.</p>
          </div>
        </li>
    </ul>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The equation uses the following variables:
    <span class="arithmatex">\(\omega_s\)</span>: signal frequency
    <span class="arithmatex">\(\omega_i\)</span>: idler frequency
    <span class="arithmatex">\(\omega_p\)</span>: pump central frequency
    <span class="arithmatex">\(\sigma_p\)</span>: pump bandwidth parameter</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.skewed_gaussian" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.skewed_gaussian</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">skewed_gaussian</span><span class="p">(</span><span class="n">lambda_p</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lambda_s</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">lambda_i</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Generate a pump envelope matrix with a skewed Gaussian profile.</p>
<p>Implements a skewed Gaussian pump envelope in frequency space according to:
$$
\alpha(\omega_s + \omega_i) = \exp\left(-\frac{(\omega_s + \omega_i - \omega_p)^2}{2\sigma_p^2}\right)
\cdot \left(1 + \text{erf}\left(\alpha \cdot \frac{\omega_s + \omega_i - \omega_p}{\sigma_p \sqrt{2}}\right)\right)
$$</p>
<p>Can be chirped according to:
$$
\chi(\omega_s + \omega_i) = \exp(-ik(\omega_s + \omega_i - \omega_p)^2),
$$</p>
<p>returning <span class="arithmatex">\(\alpha(\omega_s + \omega_i) \cdot \chi(\omega_s + \omega_i)\)</span></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>lambda_p</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Central wavelength of the pump.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>sigma_p</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Pump bandwidth.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_s</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Signal wavelengths array.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>lambda_i</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
   (citrine.citrine.Wavelength)" href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Idler wavelengths array.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>alpha</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>3.0</code>
)
          –
          <div class="doc-md-description">
            <p>Skewness parameter (default 3.0).
   Positive values skew toward lower frequencies (longer
   wavelengths),
   negative values skew toward higher frequencies (shorter
   wavelengths).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>k</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Chirp parameter, controls strength and direction of
chirp. Positive values create up-chirp, negative values create
down-chirp.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 2D pump envelope matrix.</p>
          </div>
        </li>
    </ul>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The skewed Gaussian combines a standard Gaussian with the error
    function (erf)
to create asymmetry while maintaining smoothness.</p>
</details>

    </div>

</div><h2 id="crystal-library">Crystal Library</h2>


<div class="doc doc-object doc-attribute">



<h2 id="citrine.KTiOPO4_Fradkin" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">citrine.KTiOPO4_Fradkin</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">KTiOPO4_Fradkin</span><span class="p">:</span> <span class="n">Incomplete</span> <span class="o">=</span> <span class="n">Crystal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Potassium Titanyl Phosphate&#39;</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="s1">&#39;10.1063/1.123408&#39;</span><span class="p">,</span> <span class="n">sellmeier_o</span><span class="o">=</span><span class="n">SellmeierCoefficientsTemperatureDependent</span><span class="p">(</span><span class="n">zeroth_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">2.12725</span><span class="p">,</span> <span class="mf">1.18431</span><span class="p">,</span> <span class="mf">0.0514852</span><span class="p">,</span> <span class="mf">0.6603</span><span class="p">,</span> <span class="mf">100.00507</span><span class="p">,</span> <span class="mf">0.00968956</span><span class="p">]),</span> <span class="n">first_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">9.9587</span><span class="p">,</span> <span class="mf">9.9228</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.9603</span><span class="p">,</span> <span class="mf">4.101</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-06</span><span class="p">,</span> <span class="n">second_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1882</span><span class="p">,</span> <span class="mf">10.459</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.8136</span><span class="p">,</span> <span class="mf">3.1481</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-08</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span> <span class="n">sellmeier_e</span><span class="o">=</span><span class="n">SellmeierCoefficientsTemperatureDependent</span><span class="p">(</span><span class="n">zeroth_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0993</span><span class="p">,</span> <span class="mf">0.922683</span><span class="p">,</span> <span class="mf">0.0467695</span><span class="p">,</span> <span class="mf">0.0138408</span><span class="p">]),</span> <span class="n">first_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">6.2897</span><span class="p">,</span> <span class="mf">6.3061</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0629</span><span class="p">,</span> <span class="mf">2.6486</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-06</span><span class="p">,</span> <span class="n">second_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.14445</span><span class="p">,</span> <span class="mf">2.2244</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.577</span><span class="p">,</span> <span class="mf">1.347</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-08</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span> <span class="n">phase_matching</span><span class="o">=</span><span class="n">type2_o</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="citrine.KTiOPO4_Emanueli" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">citrine.KTiOPO4_Emanueli</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">KTiOPO4_Emanueli</span><span class="p">:</span> <span class="n">Incomplete</span> <span class="o">=</span> <span class="n">Crystal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Potassium Titanyl Phosphate&#39;</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="s1">&#39;10.1364/AO.42.006661&#39;</span><span class="p">,</span> <span class="n">sellmeier_o</span><span class="o">=</span><span class="n">SellmeierCoefficientsTemperatureDependent</span><span class="p">(</span><span class="n">zeroth_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">6.2897</span><span class="p">,</span> <span class="mf">6.3061</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0629</span><span class="p">,</span> <span class="mf">2.6486</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-06</span><span class="p">,</span> <span class="n">second_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.14445</span><span class="p">,</span> <span class="mf">2.2244</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.577</span><span class="p">,</span> <span class="mf">1.347</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-08</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span> <span class="n">sellmeier_e</span><span class="o">=</span><span class="n">SellmeierCoefficientsTemperatureDependent</span><span class="p">(</span><span class="n">zeroth_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">9.9587</span><span class="p">,</span> <span class="mf">9.9228</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.9603</span><span class="p">,</span> <span class="mf">4.101</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-06</span><span class="p">,</span> <span class="n">second_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1882</span><span class="p">,</span> <span class="mf">10.459</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.8136</span><span class="p">,</span> <span class="mf">3.1481</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-08</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span> <span class="n">phase_matching</span><span class="o">=</span><span class="n">type2_o</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="citrine.KTiOAsO4_Emanueli" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">citrine.KTiOAsO4_Emanueli</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">KTiOAsO4_Emanueli</span><span class="p">:</span> <span class="n">Incomplete</span> <span class="o">=</span> <span class="n">Crystal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Potassium Titanyl Aresnate&#39;</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="s1">&#39;10.1364/AO.42.006661&#39;</span><span class="p">,</span> <span class="n">sellmeier_o</span><span class="o">=</span><span class="n">SellmeierCoefficientsTemperatureDependent</span><span class="p">(</span><span class="n">zeroth_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">4.1053</span><span class="p">,</span> <span class="mf">44.261</span><span class="p">,</span> <span class="o">-</span><span class="mf">38.012</span><span class="p">,</span> <span class="mf">11.302</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-06</span><span class="p">,</span> <span class="n">second_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5857</span><span class="p">,</span> <span class="mf">3.9386</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0081</span><span class="p">,</span> <span class="mf">1.4316</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-08</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span> <span class="n">sellmeier_e</span><span class="o">=</span><span class="n">SellmeierCoefficientsTemperatureDependent</span><span class="p">(</span><span class="n">zeroth_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">6.1537</span><span class="p">,</span> <span class="mf">64.505</span><span class="p">,</span> <span class="o">-</span><span class="mf">56.447</span><span class="p">,</span> <span class="mf">17.169</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-06</span><span class="p">,</span> <span class="n">second_order</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.96751</span><span class="p">,</span> <span class="mf">13.192</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.78</span><span class="p">,</span> <span class="mf">3.6292</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-08</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span> <span class="n">phase_matching</span><span class="o">=</span><span class="n">type2_o</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="citrine.LiNbO3_Zelmon" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">citrine.LiNbO3_Zelmon</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">LiNbO3_Zelmon</span><span class="p">:</span> <span class="n">Incomplete</span> <span class="o">=</span> <span class="n">Crystal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Lithium Niobate&#39;</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="s1">&#39;10.1364/JOSAB.14.003319&#39;</span><span class="p">,</span> <span class="n">sellmeier_o</span><span class="o">=</span><span class="n">SellmeierCoefficientsBornAndWolf</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">2.9804</span><span class="p">,</span> <span class="mf">0.02047</span><span class="p">,</span> <span class="mf">0.5981</span><span class="p">,</span> <span class="mf">0.0666</span><span class="p">,</span> <span class="mf">8.9543</span><span class="p">,</span> <span class="mf">416.08</span><span class="p">]),</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">21</span><span class="p">),</span> <span class="n">sellmeier_e</span><span class="o">=</span><span class="n">SellmeierCoefficientsBornAndWolf</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">2.6734</span><span class="p">,</span> <span class="mf">0.01764</span><span class="p">,</span> <span class="mf">1.229</span><span class="p">,</span> <span class="mf">0.05914</span><span class="p">,</span> <span class="mf">12.614</span><span class="p">,</span> <span class="mf">474.6</span><span class="p">]),</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">21</span><span class="p">),</span> <span class="n">phase_matching</span><span class="o">=</span><span class="n">type0_e</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="citrine.LiNbO3_5molMgO_Zelmon" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">citrine.LiNbO3_5molMgO_Zelmon</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">LiNbO3_5molMgO_Zelmon</span><span class="p">:</span> <span class="n">Incomplete</span> <span class="o">=</span> <span class="n">Crystal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Lithium Niobate 5Mol Magnesium Doped&#39;</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="s1">&#39;10.1364/JOSAB.14.003319&#39;</span><span class="p">,</span> <span class="n">sellmeier_o</span><span class="o">=</span><span class="n">SellmeierCoefficientsBornAndWolf</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">2.2454</span><span class="p">,</span> <span class="mf">0.01242</span><span class="p">,</span> <span class="mf">1.3005</span><span class="p">,</span> <span class="mf">0.0513</span><span class="p">,</span> <span class="mf">6.8972</span><span class="p">,</span> <span class="mf">331.33</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-06</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">21</span><span class="p">),</span> <span class="n">sellmeier_e</span><span class="o">=</span><span class="n">SellmeierCoefficientsBornAndWolf</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">2.4272</span><span class="p">,</span> <span class="mf">0.01478</span><span class="p">,</span> <span class="mf">1.4617</span><span class="p">,</span> <span class="mf">0.005612</span><span class="p">,</span> <span class="mf">9.6536</span><span class="p">,</span> <span class="mf">371.216</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-06</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">21</span><span class="p">),</span> <span class="n">phase_matching</span><span class="o">=</span><span class="n">type0_e</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="citrine.LiNbO3_Newlight" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">citrine.LiNbO3_Newlight</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">LiNbO3_Newlight</span><span class="p">:</span> <span class="n">Incomplete</span> <span class="o">=</span> <span class="n">Crystal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Lithium Niobate&#39;</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sellmeier_o</span><span class="o">=</span><span class="n">SellmeierCoefficientsSimple</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">4.9048</span><span class="p">,</span> <span class="mf">0.11768</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0475</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.027169</span><span class="p">]),</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">dn_dt</span><span class="o">=-</span><span class="mf">8.74e-07</span><span class="p">),</span> <span class="n">sellmeier_e</span><span class="o">=</span><span class="n">SellmeierCoefficientsSimple</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">4.582</span><span class="p">,</span> <span class="mf">0.099169</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04443</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02195</span><span class="p">]),</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">dn_dt</span><span class="o">=</span><span class="mf">3.9073e-05</span><span class="p">),</span> <span class="n">phase_matching</span><span class="o">=</span><span class="n">type0_e</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="citrine.LiNbO3_5molMgO_Gayer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">citrine.LiNbO3_5molMgO_Gayer</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">LiNbO3_5molMgO_Gayer</span><span class="p">:</span> <span class="n">Incomplete</span> <span class="o">=</span> <span class="n">Crystal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Lithium Niobate 5Mol Magnesium Doped&#39;</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="s1">&#39; 10.1007/s00340-008-2998-2&#39;</span><span class="p">,</span> <span class="n">sellmeier_e</span><span class="o">=</span><span class="n">SellmeierCoefficientsJundt</span><span class="p">(</span><span class="n">a_terms</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">5.756</span><span class="p">,</span> <span class="mf">0.0983</span><span class="p">,</span> <span class="mf">0.202</span><span class="p">,</span> <span class="mf">189.32</span><span class="p">,</span> <span class="mf">12.52</span><span class="p">,</span> <span class="mf">0.0132</span><span class="p">]),</span> <span class="n">b_terms</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">2.86e-06</span><span class="p">,</span> <span class="mf">4.7e-08</span><span class="p">,</span> <span class="mf">6.113e-08</span><span class="p">,</span> <span class="mf">0.0001516</span><span class="p">]),</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">24.5</span><span class="p">),</span> <span class="n">sellmeier_o</span><span class="o">=</span><span class="n">SellmeierCoefficientsJundt</span><span class="p">(</span><span class="n">a_terms</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">5.653</span><span class="p">,</span> <span class="mf">0.1185</span><span class="p">,</span> <span class="mf">0.2091</span><span class="p">,</span> <span class="mf">89.61</span><span class="p">,</span> <span class="mf">10.85</span><span class="p">,</span> <span class="mf">0.0197</span><span class="p">]),</span> <span class="n">b_terms</span><span class="o">=</span><span class="n">array</span><span class="p">([</span><span class="mf">7.941e-07</span><span class="p">,</span> <span class="mf">3.134e-08</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.641e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.188e-06</span><span class="p">]),</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">24.5</span><span class="p">),</span> <span class="n">phase_matching</span><span class="o">=</span><span class="n">type0_e</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

    </div>

</div><h2 id="brightness-and-heralding">Brightness and Heralding</h2>


<div class="doc doc-object doc-function">


<h2 id="citrine.photon_pair_coupling_filter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.photon_pair_coupling_filter</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">photon_pair_coupling_filter</span><span class="p">(</span><span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">alpha_sq</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np_over_ns</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np_over_ni</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">rho_bounds</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">theta_bounds</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate the photon pair coupling efficiency K2 for SPDC into single spatial modes.</p>
<p>This function implements Equation (26) from Smirr et al., which describes the spatial
dependence of the two-photon coupling probability P2. The function K2 accounts for
spatial interferences caused by both phase matching and coupling to the target mode.</p>
<p>The integrand Q2 contains three main physical terms:
1. Pump-target mode overlap (spatial filtering)
2. Signal-idler correlation from SPDC process
3. Phase matching with longitudinal and transverse mismatch</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>xi</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Focusing parameter ξ = L/(2zR), where L is crystal length and zR is
Rayleigh range.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>alpha_sq</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Squared normalized target mode waist parameter α² = (a0/w0)²,
where a0 is target mode waist and w0 is pump beam waist.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phi_0</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Longitudinal phase mismatch φ0 = Δk0·L (Eq. 21).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>np_over_ns</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Ratio of refractive indices np/ns (pump to signal).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>np_over_ni</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Ratio of refractive indices np/ni (pump to idler).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rho_bounds</code></b>
              (<code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>, default:
                  <code>(0, 2)</code>
)
          –
          <div class="doc-md-description">
            <p>Integration bounds for normalized
radial coordinates ρs, ρi. Defaults to (0, 2).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>theta_bounds</code></b>
              (<code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>, default:
                  <code>(0, 2 * <span title="numpy.pi">pi</span>)</code>
)
          –
          <div class="doc-md-description">
            <p>Integration bounds for angular
coordinate θ = θs - θi. Defaults to (0, 2π).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>float</code></b> (              <code><span title="float">float</span></code>
)          –
          <div class="doc-md-description">
            <p>Dimensionless photon pair coupling factor K2/(kp0·L).</p>
          </div>
        </li>
    </ul>


<details class="note" open>
  <summary>Note</summary>
  <p>Reference: Smirr et al., Eq. (26), page 5:
K2 = |∫∫ d²κs/(2π)² ∫∫ d²κi/(2π)² S̃p(κs + κi, 0) × Õ0(κs, z0)Õ0(κi, z0)
     × e^(-iz0(np/n's |κs|²/kp0 + np/n'i |κi|²/kp0)) × L sinc(ΔK(κs, κi)L/2)|²</p>
<p>The normalized coordinates are defined as:
- ρs = w0·κs/2, ρi = w0·κi/2 (Eq. 50)
- The phase mismatch ΔK includes both longitudinal (φ0) and transverse terms (Eq. 21)</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.single_photon_coupling_filter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.single_photon_coupling_filter</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">single_photon_coupling_filter</span><span class="p">(</span><span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">alpha_sq</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np_over_ns</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np_over_ni</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">rho_bounds</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">theta_bounds</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate the single photon coupling efficiency K1 for heralding ratio calculation.</p>
<p>This function implements Equation (39) from Smirr et al., which describes the
single-photon coupling probability P1. This is used to calculate the heralding
ratio Γ2|1 = K2/K1 (Eq. 41).</p>
<p>The calculation involves:
1. Inner integral over signal photon modes (with spatial filtering)
2. Outer integral over idler photon modes (free space)
3. Phase matching for the combined signal-idler system</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>xi</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Focusing parameter ξ = L/(2zR).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>alpha_sq</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Squared normalized target mode waist parameter α².</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phi_0</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Longitudinal phase mismatch φ0 = Δk0·L.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>np_over_ns</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Ratio of refractive indices np/ns.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>np_over_ni</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Ratio of refractive indices np/ni.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rho_bounds</code></b>
              (<code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>, default:
                  <code>(0, 2)</code>
)
          –
          <div class="doc-md-description">
            <p>Integration bounds for normalized
radial coordinates. Defaults to (0, 2).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>theta_bounds</code></b>
              (<code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>, default:
                  <code>(-<span title="numpy.pi">pi</span>, <span title="numpy.pi">pi</span>)</code>
)
          –
          <div class="doc-md-description">
            <p>Integration bounds for angular
coordinate. Defaults to (-π, π).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>float</code></b> (              <code><span title="float">float</span></code>
)          –
          <div class="doc-md-description">
            <p>Dimensionless single photon coupling factor K1/(kp0·L).</p>
          </div>
        </li>
    </ul>


<details class="note" open>
  <summary>Note</summary>
  <p>Reference: Smirr et al., Eq. (39), page 6:
K1 = ∫∫ d²κi/(2π)² |∫∫ d²κs/(2π)² S̃p(κs + κi, 0)Õ0(κs, z0)
     × e^(-iz0 np/n's |κs|²/kp0) L sinc(ΔK L/2)|²</p>
<p>K1 represents the probability of detecting at least one photon in the target
spatial mode, which is needed to calculate the conditional probability (heralding
ratio) of detecting the second photon given that the first was detected.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.brightness_and_heralding" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.brightness_and_heralding</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">brightness_and_heralding</span><span class="p">(</span><span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">n_p</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">n_i</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">n_s</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">rho_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate brightness factors K1, K2 and heralding ratio for SPDC source optimization.</p>
<p>This function combines the calculations from Equations (26), (39), and (41) in
Smirr et al. to provide the key figures of merit for SPDC source performance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>xi</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Focusing parameter ξ = L/(2zR), where L is crystal length and zR is
pump beam Rayleigh range. Typical range: 0.1 to 10.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>alpha</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Normalized target mode waist α = a0/w0, where a0 is target mode
waist and w0 is pump beam waist. Optimal value around 1-2.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phi_0</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Longitudinal phase mismatch φ0 = Δk0·L. Optimization parameter
for temperature tuning.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_p</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Pump refractive index at pump wavelength.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_i</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Idler refractive index at idler wavelength.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_s</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Signal refractive index at signal wavelength.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rho_max</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>2.0</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum integration bound for normalized radial
coordinates. Defaults to 2.0, which provides good convergence.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>]</code>
          –
          <div class="doc-md-description">
            <p>Tuple[float, float, float]: A tuple containing:
- K1 (float): Single photon coupling factor K1/(kp0·L). Related to heralded
  single photon brightness.</p>
<ul>
<li>
<p>K2 (float): Photon pair coupling factor K2/(kp0·L). Related to coincidence
  brightness.</p>
</li>
<li>
<p>heralding (float): Heralding ratio Γ2|1 = K2/K1. Measures the conditional
  probability of detecting the idler photon given detection of the signal photon.</p>
</li>
</ul>
          </div>
        </li>
    </ul>


<details class="note" open>
  <summary>Note</summary>
  <p>References:
- K2: Smirr et al., Eq. (26) - spatial filtering factor for pair collection
- K1: Smirr et al., Eq. (39) - spatial filtering factor for single photon
- Γ2|1: Smirr et al., Eq. (41) - heralding ratio for single photon sources</p>
<p>The heralding ratio Γ2|1 is a key figure of merit for single photon sources,
as it determines the quality of heralded single photons. Values closer to 1
indicate better performance, with typical experimental values of 0.5-0.9.</p>
<p>For entangled pair sources, both K1 and K2 should be maximized to optimize
the coincidence detection rate while maintaining good spatial mode purity.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.calculate_optimisation_grid" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.calculate_optimisation_grid</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_optimisation_grid</span><span class="p">(</span><span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">alpha_range</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">phi0_range</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">n_p</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">n_s</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">n_i</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">rho_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Calculate optimization grids for SPDC source design across parameter space.</p>
<p>This function systematically evaluates the brightness factors K1, K2 and heralding
ratio across ranges of the normalized target mode waist (α) and longitudinal phase
mismatch (φ0) parameters. This enables optimization of SPDC sources as described
in Section III.C of Smirr et al.</p>
<p>The results can be used to generate contour plots like Figures 3, 4, and 6 in the
paper, showing the optimal parameter combinations for different focusing conditions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>xi</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Focusing parameter ξ = L/(2zR). Different values correspond to
different pump beam focusing conditions (see Fig. 4 in paper).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>alpha_range</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Range of normalized target
mode waist values α = a0/w0 to evaluate. Typical range: 0.5 to 3.5
(see Fig. 3 in paper).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phi0_range</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Range of longitudinal phase
mismatch values φ0 = Δk0·L to evaluate. This parameter is typically
optimized via crystal temperature control.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_p</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Pump refractive index.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_s</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Signal refractive index.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_i</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Idler refractive index.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rho_max</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>2.0</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum integration bound for radial coordinates.
Defaults to 2.0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>progress_bar</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to display progress bar during calculation.
Defaults to True.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>Tuple[NDArray, NDArray, NDArray]: A tuple containing:
- K1_grid (NDArray): 2D array with shape (n_phi, n_alpha) of single photon
  coupling efficiency values for heralding calculations.
- K2_grid (NDArray): 2D array with shape (n_phi, n_alpha) of photon pair
  coupling efficiency values for brightness optimization (Fig. 3).
- ratio_grid (NDArray): 2D array with shape (n_phi, n_alpha) of heralding
  ratio Γ2|1 values for heralding optimization (Fig. 6).</p>
          </div>
        </li>
    </ul>


<details class="note" open>
  <summary>Note</summary>
  <p>This function enables the systematic optimization described in Section III.C:
1. For brightness optimization: find (α, φ0) that maximizes K2_grid
2. For heralding optimization: find (α, φ0) that maximizes ratio_grid
3. For balanced optimization: find compromise between brightness and heralding</p>
<p>The optimal parameters typically follow the Boyd-Kleinman conditions for
second harmonic generation, adapted for the down-conversion geometry.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="citrine.make_lookup_table" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">citrine.make_lookup_table</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_lookup_table</span><span class="p">(</span><span class="n">xi_values</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">phi_0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">crystal</span><span class="p">:</span> <span class="n">Crystal</span><span class="p">,</span> <span class="n">wavelength_pump</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">wavelength_signal</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">wavelength_idler</span><span class="p">:</span> <span class="n">Wavelength</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">temp_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rho_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Generate lookup tables for SPDC optimization across focusing parameter range.</p>
<p>This function creates comprehensive lookup tables that enable fast interpolation
of brightness and heralding calculations across different focusing conditions.
This is essential for the systematic optimization described in Section III of
Smirr et al., where multiple ξ values must be evaluated to find global optima.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>xi_values</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Range of focusing parameter
values ξ = L/(2zR) to calculate. Typical range: 0.1 to 10 (from collimated
to tightly focused).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>alpha</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Range of normalized target mode
waist values α = a0/w0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phi_0</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Range of longitudinal phase
mismatch values φ0 = Δk0·L.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>crystal</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Crystal" href="#citrine.Crystal">Crystal</a></code>)
          –
          <div class="doc-md-description">
            <p>Crystal object containing material properties and
Sellmeier equations.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>wavelength_pump</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
  " href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Wavelength object for pump beam.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>wavelength_signal</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
  " href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Wavelength object for signal beam.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>wavelength_idler</code></b>
              (<code><a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
  " href="#citrine.Wavelength">Wavelength</a></code>)
          –
          <div class="doc-md-description">
            <p>Wavelength object for idler beam.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>name</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Output filename for the lookup table pickle file.
Defaults to None (auto-generated).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>temp_dir</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Directory for temporary storage of
intermediate results. Defaults to None.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rho_max</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>2.0</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum radial integration bound. Defaults to 2.0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Crystal temperature for refractive index
calculations. Defaults to None.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>overwrite</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to overwrite existing intermediate files.
Defaults to False.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="dict">dict</span></code>
          –
          <div class="doc-md-description">
            <p>Tuple[BrightnessHeraldingLUT, str]: A tuple containing:
- lookup_table (BrightnessHeraldingLUT): Lookup table object containing all
  calculated grids and parameters.
- filename (str): Path to the saved lookup table file.</p>
          </div>
        </li>
    </ul>


<details class="note" open>
  <summary>Note</summary>
  <p>The lookup table enables:
1. Fast parameter optimization without recalculating integrals
2. Interpolation between calculated points for smooth optimization
3. Systematic comparison across different focusing regimes</p>
<p>The lookup table structure enables the optimization workflow from Fig. 4:
1. Calculate grids for multiple ξ values
2. Find optimal (α, φ0) for each ξ
3. Determine global optimum across all ξ values
4. Use interpolation for fine-tuning around optima</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="citrine.BrightnessHeraldingLUT" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">citrine.BrightnessHeraldingLUT</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">BrightnessHeraldingLUT</span><span class="p">(</span><span class="n">refractive_index</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">wavelength</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Wavelength</span><span class="p">],</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">xi</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">phi</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">K1</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">K2</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">],</span> <span class="n">Heralding</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents first">


        <p>Lookup table for SPDC brightness and heralding optimization.</p>
<p>This class encapsulates the complete parameter space calculations needed for
SPDC source optimization as described in Smirr et al. It provides methods for
interpolating between calculated points and extracting optimal parameters.</p>
<p>The lookup table enables rapid optimization across the multidimensional parameter
space (ξ, α, φ0) without recalculating expensive integrals.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.BrightnessHeraldingLUT.refractive_index">refractive_index</span></code></b>
              (<code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Refractive indices for pump, signal,
and idler wavelengths.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.BrightnessHeraldingLUT.wavelength">wavelength</span></code></b>
              (<code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="            citrine.Wavelength


  
      dataclass
  " href="#citrine.Wavelength">Wavelength</a>]</code>)
          –
          <div class="doc-md-description">
            <p>Wavelength specifications for
the three interacting beams.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.BrightnessHeraldingLUT.temperature">temperature</span></code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Crystal temperature used for calculations.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.BrightnessHeraldingLUT.xi">xi</span></code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Focusing parameter values ξ = L/(2zR).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.BrightnessHeraldingLUT.alpha">alpha</span></code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Normalized target mode waist
values α = a0/w0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.BrightnessHeraldingLUT.phi">phi</span></code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Longitudinal phase mismatch
values φ0 = Δk0·L.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.BrightnessHeraldingLUT.K1">K1</span></code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Single photon coupling efficiency grids with
shape (n_xi, n_phi, n_alpha).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.BrightnessHeraldingLUT.K2">K2</span></code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Photon pair coupling efficiency grids with
shape (n_xi, n_phi, n_alpha).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="citrine.BrightnessHeraldingLUT.Heralding">Heralding</span></code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Heralding ratio grids Γ2|1 = K2/K1 with
shape (n_xi, n_phi, n_alpha).</p>
          </div>
        </li>
    </ul>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            from_file


  
      classmethod
   (citrine.BrightnessHeraldingLUT.from_file)" href="#citrine.BrightnessHeraldingLUT.from_file">from_file</a></code></b>
            –
            <div class="doc-md-description">
              <p>Load lookup table from pickled file.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            interpolate (citrine.BrightnessHeraldingLUT.interpolate)" href="#citrine.BrightnessHeraldingLUT.interpolate">interpolate</a></code></b>
            –
            <div class="doc-md-description">
              <p>Create interpolated grids for specified focusing parameter values.</p>
            </div>
          </li>
    </ul>






  <div class="doc doc-children">







<h3 id="citrine.BrightnessHeraldingLUT-functions">Functions</h3>

<div class="doc doc-object doc-function">


<h4 id="citrine.BrightnessHeraldingLUT.from_file" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_file</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load lookup table from pickled file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>path</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Path to the pickled lookup table file.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>BrightnessHeraldingLUT</code></b>          –
          <div class="doc-md-description">
            <p>Loaded lookup table object.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="citrine.BrightnessHeraldingLUT.interpolate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">interpolate</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">interpolate</span><span class="p">(</span><span class="n">target_xi_values</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create interpolated grids for specified focusing parameter values.</p>
<p>This method enables fine-grained optimization by interpolating between
the calculated lookup table points. This is particularly useful for
finding precise optimal parameters around the global maxima identified
from the coarse grid calculations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>target_xi_values</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="typing.List">List</span>[<span title="float">float</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Focusing parameter values for which to create interpolated grids.
These can be between the original calculated ξ values.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]]</code>
          –
          <div class="doc-md-description">
            <p>Tuple[NDArray[np.floating], NDArray[np.floating], NDArray[np.floating]]:
A tuple containing:
- interpolated_grids (dict): Dictionary with ξ values as keys, each
  containing 'K2_grid' and 'heralding_grid' for interpolated
  brightness and heralding optimization grids.
- alpha_range (NDArray): Alpha values used in the grids (from
  original lookup table).
- phi0_range (NDArray): Phi0 values used in the grids (from
  original lookup table).</p>
          </div>
        </li>
    </ul>


<details class="note" open>
  <summary>Note</summary>
  <p>The interpolation uses RegularGridInterpolator for smooth, continuous
parameter optimization. This enables finding optimal parameters with
higher precision than the original grid spacing.</p>
<p>Warning will be issued if target ξ values are outside the lookup table range.</p>
</details>

    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2024 Peter Thomas Barrow
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Peter-Barrow/citrine" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.indexes", "navigation.top", "navigation.instant"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>